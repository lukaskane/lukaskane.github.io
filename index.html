<html>

<head>
    <style>
        body {
            width: 960px;
            margin: 0 auto;
        }

        #root {
            width: 100%;
        }

        .col {
            width: 10px;
            height: 10px;
            margin: 2px;
            border-radius: 5px;
            background: rgb(218, 236, 243);
            display: inline-block;
        }

        #controls {
            width: 200px;
            height: 100px;
        }

        .control {
            width: 50px;
            height: 50px;
            background: white;
            border: 2px solid black;
            cursor: pointer;
            user-select: none;
        }

        #controls>#up {
            margin-left: 58px;
            margin-bottom: 2px;
        }

        #controls>#left,
        #right,
        #down {
            display: inline-block;
        }
    </style>
</head>

<body>
    <div id="root"></div>
</body>
<script>
    class Interface {
        constructor() {
            this.mapLimit = 50;
            this._drawArea();
            this.rows = document.getElementsByClassName("row");
            this.currentElement = this.getCell(this.mapLimit / 2, this.mapLimit / 2);
            this.currentElement.markChoosen();
        }

        _drawArea() {
            var root = document.getElementById("root");

            for (var i = 0; i <= this.mapLimit; i++) {
                let row = document.createElement("div");
                row.id = "row" + i;
                row.className = "row";
                root.appendChild(row);

                for (var j = 0; j <= this.mapLimit; j++) {
                    var col = document.createElement("div");
                    col.id = "col" + j;
                    col.className = "col";
                    row.appendChild(col);
                }
            }
        }
        move(x, y) {
            var cords = this.currentElement.coordinates;
            if (!this.currentElement.neighbours.up && y < 0) y = 0;
            if (!this.currentElement.neighbours.down && y > 0) y = 0;
            if (!this.currentElement.neighbours.left && x < 0) x = 0;
            if (!this.currentElement.neighbours.right && x > 0) x = 0;

            this.currentElement.markAfter();
            this.currentElement = this.getCell(cords.x + x, cords.y + y);
            this.currentElement.markChoosen();
        }
        getCell(x, y) {
            return new Cell(x, y, this);
        }

        clearArea() {
            for (var i = 0; i <= this.mapLimit; i++) {
                for (var j = 0; j <= this.mapLimit; j++) {
                    var cell = new Cell(i, j, this).markDefault();
                }
            }
        }

    }
    class Cell {
        constructor(x, y, control) {
            this.rows = document.getElementsByClassName("row");
            this.cell = this._getCell(x, y);
            this._CHOOSEN = "rgb(211, 121, 230)";
            this._DEFAULT = "rgb(218, 236, 243)";
            this._AFTER = "rgb(247, 230, 255)";
            this.mapLimit = control.mapLimit;
        }
        get neighbours() {
            var cords = this.coordinates;
            var upperNeighbour = cords.y > 0 ? this._getCell(cords.x, cords.y - 1) : undefined,
                lowerNeighbour = cords.y < this.mapLimit ? this._getCell(cords.x, cords.y + 1) : undefined,
                leftNeighbour = cords.x > 0 ? this._getCell(cords.x - 1, cords.y) : undefined,
                rightNeighbour = cords.x < this.mapLimit ? this._getCell(cords.x + 1, cords.y) : undefined;
            return {
                up: upperNeighbour,
                down: lowerNeighbour,
                left: leftNeighbour,
                right: rightNeighbour
            }
        }

        _getCell(x, y) {
            return this.rows[y].children[x];
        }

        markChoosen() {
            this.cell.style.background = this._CHOOSEN;
        }

        markAfter() {
            this.cell.style.background = this._AFTER;
        }

        markDefault() {
            this.cell.style.background = this._DEFAULT;
        }

        isNew() {
            return this.cell.style.background == this._DEFAULT;
        }

        get coordinates() {
            return {
                x: +this.cell.id.match(/[\d]/g).join(""),
                y: +this.cell.parentElement.id.match(/[\d]/g).join("")
            }
        }
    }

    var control = new Interface();

    document.addEventListener('keydown', (event) => {

        const keyName = event.key;
        var directionMap = {
            ArrowLeft: {
                x: -1,
                y: 0
            },
            ArrowRight: {
                x: 1,
                y: 0
            },
            ArrowUp: {
                x: 0,
                y: -1
            },
            ArrowDown: {
                x: 0,
                y: 1
            }
        };
        if (Object.keys(directionMap).some(key => keyName == key)) {

            var direction = directionMap[keyName];
            control.move(direction.x, direction.y);
        }

    }, false);
</script>

</html>
